<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SuperPrompt Jornal√≠stico</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
            border-radius: 20px 20px 0 0;
        }
        .header h1 { font-size: 2.5em; margin-bottom: 10px; }
        .header p { font-size: 1.2em; opacity: 0.9; }
        .content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            padding: 30px;
        }
        .card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            border: 2px solid #e9ecef;
        }
        .card h2 { color: #495057; margin-bottom: 20px; font-size: 1.4em; }
        .form-group { margin-bottom: 20px; }
        label {
            display: block;
            color: #495057;
            font-weight: 600;
            margin-bottom: 8px;
        }
        input, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 1em;
            font-family: inherit;
        }
        input:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        textarea { resize: vertical; min-height: 250px; }
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.1em;
            font-weight: 600;
            border-radius: 10px;
            cursor: pointer;
            width: 100%;
            text-transform: uppercase;
            transition: all 0.3s;
        }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3); }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .alert-info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
        .alert-success { background: #d4edda; color: #155724; }
        .alert-error { background: #f8d7da; color: #721c24; }
        .loading {
            text-align: center;
            padding: 40px;
            display: none;
        }
        .loading.active { display: block; }
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .result { display: none; max-height: 80vh; overflow-y: auto; }
        .result.active { display: block; }
        .resultado-section {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .resultado-section h3 {
            color: #667eea;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e9ecef;
        }
        .titulo-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 4px solid #667eea;
        }
        .titulo-texto {
            font-size: 1.1em;
            font-weight: 600;
            color: #212529;
            margin-bottom: 10px;
        }
        .titulo-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            font-size: 0.85em;
            margin-bottom: 10px;
        }
        .badge {
            padding: 4px 10px;
            border-radius: 12px;
            font-weight: 600;
        }
        .copy-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s;
        }
        .copy-btn:hover { background: #218838; }
        .download-btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            width: 100%;
            margin-top: 20px;
        }
        .download-btn:hover { background: #0056b3; }
        small { display: block; color: #6c757d; margin-top: 5px; font-size: 0.85em; }
        @media (max-width: 768px) { .content { grid-template-columns: 1fr; } }
        .step-box {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
        }
        .step-box strong { color: #856404; }
        .step-box ol { margin: 10px 0 10px 20px; color: #856404; }
        .step-box li { margin: 5px 0; }
        .config-box {
            background: #d4edda;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
            color: #155724;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üì∞ SuperPrompt Jornal√≠stico</h1>
            <p>12+ T√≠tulos Otimizados + Thumbnails + SEO + Testes A/B</p>
        </div>

        <div class="content">
            <div>
                <div class="card">
                    <h2>üîë 1. API Key</h2>
                    <div id="apiSaved" class="config-box" style="display: none;">‚úÖ API Key configurada!</div>
                    <div class="alert alert-info">
                        <strong>üìå Passo 1:</strong> Pegue sua API Key em:
                        <a href="https://console.anthropic.com/" target="_blank">console.anthropic.com</a>
                    </div>
                    <div class="form-group">
                        <label>Sua API Key:</label>
                        <input type="password" id="apiKey" placeholder="sk-ant-...">
                        <small>Ser√° salva no navegador</small>
                    </div>
                    <button class="btn" onclick="salvarApiKey()">üíæ Salvar</button>
                </div>

                <div class="card" style="margin-top: 20px;">
                    <h2>üìù 2. Sua Mat√©ria</h2>
                    <div class="step-box">
                        <strong>üìñ Instru√ß√µes:</strong>
                        <ol>
                            <li>Copie o t√≠tulo da not√≠cia</li>
                            <li>Cole no campo abaixo</li>
                            <li>Copie TODO o texto</li>
                            <li>Cole no campo "Corpo"</li>
                            <li>Clique em "Processar"</li>
                        </ol>
                    </div>
                    <div class="form-group">
                        <label>T√≠tulo:</label>
                        <input type="text" id="titulo" placeholder="Cole o t√≠tulo">
                    </div>
                    <div class="form-group">
                        <label>Corpo:</label>
                        <textarea id="corpo" placeholder="Cole todo o texto da mat√©ria..."></textarea>
                    </div>
                    <button class="btn" onclick="processar()" id="btnProcessar">üöÄ Processar</button>
                </div>
            </div>

            <div class="card">
                <h2>üìä 3. Resultado</h2>
                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <p><strong>Processando...</strong></p>
                    <small>Aguarde 15-20 segundos</small>
                </div>
                <div class="result" id="result">
                    <div class="alert alert-info">
                        <strong>üí° Aguardando...</strong><br>
                        Configure a API Key e cole sua mat√©ria!
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function salvarApiKey() {
            const apiKey = document.getElementById('apiKey').value.trim();
            if (!apiKey) { alert('‚ö†Ô∏è Digite sua API Key!'); return; }
            if (!apiKey.startsWith('sk-')) { alert('‚ö†Ô∏è API Key inv√°lida!'); return; }
            localStorage.setItem('anthropic_api_key', apiKey);
            document.getElementById('apiSaved').style.display = 'block';
            alert('‚úÖ API Key salva!');
        }

        window.onload = function() {
            const saved = localStorage.getItem('anthropic_api_key');
            if (saved) {
                document.getElementById('apiKey').value = saved;
                document.getElementById('apiSaved').style.display = 'block';
            }
        }

        async function processar() {
            const titulo = document.getElementById('titulo').value.trim();
            const corpo = document.getElementById('corpo').value.trim();
            const apiKey = localStorage.getItem('anthropic_api_key');

            if (!apiKey) { alert('‚ö†Ô∏è Configure API Key!'); return; }
            if (!titulo) { alert('‚ö†Ô∏è Cole o t√≠tulo!'); return; }
            if (!corpo || corpo.length < 100) { alert('‚ö†Ô∏è Cole o texto completo!'); return; }

            document.getElementById('loading').classList.add('active');
            document.getElementById('result').classList.remove('active');
            document.getElementById('btnProcessar').disabled = true;

            try {
                const resultado = await chamarClaude(apiKey, titulo, corpo);
                exibirResultado(resultado);
            } catch (error) {
                exibirErro(error.message);
            } finally {
                document.getElementById('loading').classList.remove('active');
                document.getElementById('btnProcessar').disabled = false;
            }
        }

        async function chamarClaude(apiKey, titulo, corpo) {
            const response = await fetch('https://api.anthropic.com/v1/messages', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'x-api-key': apiKey,
                    'anthropic-version': '2023-06-01'
                },
                body: JSON.stringify({
                    model: 'claude-sonnet-4-20250514',
                    max_tokens: 8000,
                    temperature: 0.8,
                    messages: [{
                        role: 'user',
                        content: `Voc√™ √© editor especialista. Gere JSON com 12+ t√≠tulos otimizados, 3 thumbnails, SEO e 3 testes A/B.

MAT√âRIA:
T√≠tulo: ${titulo}
Corpo: ${corpo}

REGRAS: N√ÉO invente fatos, evite clickbait enganoso.

JSON (sem markdown):
{
  "titles": [{"text": "...", "type": "pergunta", "emotion_level": "m√©dio", "curiosity_level": "alto", "clickbait_risk": "baixo", "trust_level": "alto"}],
  "thumbnails": [{"scene": "...", "props": "...", "overlay_text": "..."}],
  "seo": {"title": "...", "meta_description": "...", "keywords": ["..."]},
  "ab_tests": [{"variant_A": "...", "variant_B": "...", "metric": "CTR"}]
}`
                    }]
                })
            });

            if (!response.ok) throw new Error('Erro na API');
            const data = await response.json();
            let texto = data.content[0].text.trim();
            texto = texto.replace(/```json\n?/g, '').replace(/```\n?/g, '').trim();
            const match = texto.match(/\{[\s\S]*\}/);
            if (match) texto = match[0];
            return JSON.parse(texto);
        }

        function exibirResultado(resultado) {
            let html = '';
            if (resultado.titles) {
                html += `<div class="resultado-section"><h3>üìù ${resultado.titles.length} T√≠tulos</h3>`;
                resultado.titles.forEach((t, i) => {
                    html += `<div class="titulo-item">
                        <div class="titulo-texto">${i+1}. ${t.text}</div>
                        <div class="titulo-meta">
                            <span class="badge" style="background:#e7f3ff">${t.type}</span>
                            <span class="badge" style="background:#fff3cd">üòä ${t.emotion_level}</span>
                            <span class="badge" style="background:#d4edda">‚úÖ ${t.trust_level}</span>
                        </div>
                        <button class="copy-btn" onclick="copiar(\`${t.text.replace(/`/g, '\\`')}\`)">üìã Copiar</button>
                    </div>`;
                });
                html += '</div>';
            }
            if (resultado.seo) {
                html += `<div class="resultado-section"><h3>üîç SEO</h3>
                    <div class="titulo-item">
                        <strong>Title:</strong> ${resultado.seo.title}<br>
                        <strong>Description:</strong> ${resultado.seo.meta_description}<br>
                        <strong>Keywords:</strong> ${resultado.seo.keywords.join(', ')}
                    </div></div>`;
            }
            document.getElementById('result').innerHTML = html;
            document.getElementById('result').classList.add('active');
        }

        function exibirErro(msg) {
            document.getElementById('result').innerHTML = `<div class="alert alert-error"><strong>‚ùå Erro:</strong><br>${msg}</div>`;
            document.getElementById('result').classList.add('active');
        }

        function copiar(texto) {
            navigator.clipboard.writeText(texto).then(() => alert('‚úÖ Copiado!'));
        }
    </script>
</body>
</html>
